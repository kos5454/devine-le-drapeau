/* ================================================
   DEVINE LE DRAPEAU — style.css  v2
================================================ */

/* ── TOKENS ──────────────────────────────────── */
:root {
  --bg:          #0f1117;
  --bg-card:     #1a1d27;
  --bg-card2:    #22263a;
  --border:      #2e3348;
  --text:        #e8eaf6;
  --muted:       #7b82a8;
  --accent:      #6c63ff;
  --accent-glow: rgba(108,99,255,.35);
  --ok:          #22c55e;
  --ok-bg:       rgba(34,197,94,.12);
  --err:         #ef4444;
  --err-bg:      rgba(239,68,68,.12);
  --warn:        #f59e0b;
  --r-sm: 8px; --r-md: 16px; --r-lg: 24px;
  --shadow: 0 8px 32px rgba(0,0,0,.45);
  --t: .2s cubic-bezier(.4,0,.2,1);
}

/* ── RESET ───────────────────────────────────── */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{font-size:16px;scroll-behavior:smooth}
body{
  font-family:'Inter',system-ui,sans-serif;
  background:var(--bg);
  color:var(--text);
  min-height:100dvh;
  display:flex;align-items:center;justify-content:center;
  padding:16px;
  background-image:radial-gradient(ellipse 80% 60% at 50% -10%,rgba(108,99,255,.16) 0%,transparent 70%);
}

/* ── SCREENS ─────────────────────────────────── */
.screen{display:none;width:100%;max-width:520px;animation:fadeUp .32s ease both}
.screen.active{display:flex;justify-content:center}
@keyframes fadeUp{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:none}}

/* ======================================================
   WELCOME
====================================================== */
.welcome-card{
  background:var(--bg-card);border:1px solid var(--border);
  border-radius:var(--r-lg);padding:52px 36px 44px;
  text-align:center;width:100%;box-shadow:var(--shadow);
}
.logo{font-size:3.5rem;margin-bottom:16px;display:block;
  filter:drop-shadow(0 4px 16px rgba(108,99,255,.4))}
h1{
  font-size:2rem;font-weight:800;letter-spacing:-.03em;margin-bottom:12px;
  background:linear-gradient(135deg,#fff 0%,var(--accent) 100%);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
}
.subtitle{color:var(--muted);font-size:.95rem;line-height:1.6;margin-bottom:28px}

/* ======================================================
   SELECTION SCREENS (continent + mode)
====================================================== */
.selection-wrapper{
  background:var(--bg-card);border:1px solid var(--border);
  border-radius:var(--r-lg);padding:32px 28px 28px;
  width:100%;box-shadow:var(--shadow);
  display:flex;flex-direction:column;gap:20px;
}
.selection-header h2{font-size:1.4rem;font-weight:800;letter-spacing:-.02em}
.selection-header .subtitle{margin-bottom:0}
.context-pills{margin-bottom:4px;display:flex;gap:8px;flex-wrap:wrap}
.pill{
  display:inline-flex;align-items:center;gap:6px;
  background:rgba(108,99,255,.15);border:1px solid rgba(108,99,255,.3);
  border-radius:99px;padding:4px 12px;font-size:.8rem;font-weight:600;color:var(--accent);
}

/* ── Continent grid ── */
.continent-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.continent-card{
  background:var(--bg-card2);border:1.5px solid var(--border);
  border-radius:var(--r-md);padding:16px 14px;cursor:pointer;
  transition:all var(--t);display:flex;flex-direction:column;gap:6px;
  text-align:left;
}
.continent-card:hover{border-color:var(--accent);background:rgba(108,99,255,.07);transform:translateY(-2px)}
.continent-card.selected{border-color:var(--accent);background:rgba(108,99,255,.14);box-shadow:0 0 0 3px var(--accent-glow)}
.continent-icon{font-size:2rem;line-height:1}
.continent-name{font-size:.95rem;font-weight:700}
.continent-count{font-size:.75rem;color:var(--muted);font-weight:500}

/* ── Mode grid ── */
.mode-grid{display:flex;flex-direction:column;gap:10px}
.mode-card{
  background:var(--bg-card2);border:1.5px solid var(--border);
  border-radius:var(--r-md);padding:14px 16px;cursor:pointer;
  transition:all var(--t);display:flex;align-items:center;gap:14px;text-align:left;
}
.mode-card:hover{border-color:var(--accent);background:rgba(108,99,255,.07);transform:translateX(3px)}
.mode-card.selected{border-color:var(--accent);background:rgba(108,99,255,.13)}
.mode-icon{font-size:1.6rem;width:36px;text-align:center;flex-shrink:0}
.mode-info{flex:1}
.mode-name{font-size:.95rem;font-weight:700;margin-bottom:2px}
.mode-desc{font-size:.78rem;color:var(--muted);line-height:1.4}
.mode-tags{display:flex;gap:5px;margin-top:6px;flex-wrap:wrap}
.mode-tag-pill{
  font-size:.68rem;font-weight:600;padding:2px 8px;border-radius:99px;
  background:rgba(108,99,255,.15);border:1px solid rgba(108,99,255,.25);color:var(--accent);
}
.mode-tag-pill.warn{background:rgba(245,158,11,.12);border-color:rgba(245,158,11,.25);color:var(--warn)}
.mode-arrow{color:var(--muted);font-size:1.1rem;flex-shrink:0}

/* ======================================================
   BUTTONS
====================================================== */
.btn-primary{
  width:100%;padding:15px;border-radius:var(--r-md);border:none;
  background:var(--accent);color:#fff;font-size:1rem;font-weight:700;
  cursor:pointer;transition:var(--t);position:relative;overflow:hidden;
  font-family:inherit;letter-spacing:.01em;
}
.btn-primary::after{
  content:'';position:absolute;inset:0;
  background:linear-gradient(180deg,rgba(255,255,255,.12) 0%,transparent 100%);
  pointer-events:none;
}
.btn-primary:not(:disabled):hover{transform:translateY(-2px);box-shadow:0 6px 24px var(--accent-glow)}
.btn-primary:active{transform:none}
.btn-primary:disabled{opacity:.4;cursor:not-allowed}

.btn-secondary{
  width:100%;padding:13px;border-radius:var(--r-md);
  border:1px solid var(--border);background:transparent;
  color:var(--muted);font-size:.92rem;font-weight:600;cursor:pointer;
  transition:var(--t);font-family:inherit;
}
.btn-secondary:hover{border-color:var(--accent);color:var(--accent)}

.btn-back{margin-top:0}

.btn-icon{
  width:36px;height:36px;border-radius:50%;border:1px solid var(--border);
  background:var(--bg-card2);color:var(--muted);font-size:.9rem;
  cursor:pointer;display:flex;align-items:center;justify-content:center;
  transition:var(--t);flex-shrink:0;
}
.btn-icon:hover{border-color:var(--err);color:var(--err)}

/* ======================================================
   GAME SCREEN
====================================================== */
.game-wrapper{
  background:var(--bg-card);border:1px solid var(--border);
  border-radius:var(--r-lg);padding:20px 20px 24px;
  width:100%;box-shadow:var(--shadow);
  display:flex;flex-direction:column;gap:12px;
}

/* Top bar */
.top-bar{display:flex;align-items:center;gap:8px}
.top-left{flex:1;display:flex;align-items:center;gap:8px;min-width:0}
.mode-tag{
  display:inline-block;font-size:.68rem;font-weight:700;
  padding:3px 8px;border-radius:99px;
  background:rgba(108,99,255,.18);border:1px solid rgba(108,99,255,.3);color:var(--accent);
  white-space:nowrap;flex-shrink:0;
}
#question-counter{font-size:.82rem;font-weight:600;color:var(--muted);letter-spacing:.03em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.score-badge{
  display:flex;flex-direction:column;align-items:center;
  background:var(--bg-card2);border:1px solid var(--border);
  border-radius:var(--r-sm);padding:5px 12px;min-width:56px;flex-shrink:0;
}
.score-label{font-size:.6rem;font-weight:600;color:var(--muted);text-transform:uppercase;letter-spacing:.08em}
#score-value{font-size:1.15rem;font-weight:800;color:var(--accent);line-height:1.2}

/* Progress bar */
.progress-bar-track{height:4px;background:var(--bg-card2);border-radius:99px;overflow:hidden}
.progress-bar-fill{
  height:100%;width:0%;
  background:linear-gradient(90deg,var(--accent),#a78bfa);
  border-radius:99px;transition:width .5s cubic-bezier(.4,0,.2,1);
}

/* Streak bar (survival) */
.streak-bar{
  display:none;align-items:center;gap:8px;
  background:var(--bg-card2);border:1px solid var(--border);
  border-radius:var(--r-sm);padding:10px 14px;
}
.streak-bar.show{display:flex}
.streak-icon{font-size:1.2rem}
#streak-count{font-size:1.3rem;font-weight:800;color:var(--warn)}
.streak-label{font-size:.8rem;color:var(--muted);flex:1}
.streak-record-label{font-size:.78rem;color:var(--muted)}
.streak-record-label strong{color:var(--text)}

/* Chrono wrap */
.chrono-wrap{
  display:none;align-items:center;gap:10px;
}
.chrono-wrap.show{display:flex}
.chrono-bar-track{flex:1;height:8px;background:var(--bg-card2);border-radius:99px;overflow:hidden}
.chrono-bar-fill{
  height:100%;width:100%;
  background:linear-gradient(90deg,var(--ok),var(--accent));
  border-radius:99px;
  transition:width .9s linear,background .5s;
}
.chrono-bar-fill.warn{background:linear-gradient(90deg,var(--err),var(--warn))}
#chrono-time{
  font-size:1.1rem;font-weight:800;color:var(--text);
  min-width:32px;text-align:right;flex-shrink:0;
}

/* ── Flag card (standard / hardcore) ── */
.flag-card{
  background:var(--bg-card2);border:1px solid var(--border);
  border-radius:var(--r-md);padding:20px;
  display:flex;justify-content:center;align-items:center;min-height:170px;
  position:relative;overflow:hidden;
}
.flag-wrap{position:relative;display:flex;align-items:center;justify-content:center;width:100%}
#flag-img{
  max-width:280px;width:100%;height:auto;
  border-radius:var(--r-sm);box-shadow:0 4px 20px rgba(0,0,0,.5);
  display:block;transition:opacity .2s;object-fit:cover;aspect-ratio:3/2;
}
.flag-shimmer{
  position:absolute;inset:0;border-radius:var(--r-sm);
  background:linear-gradient(90deg,transparent 25%,rgba(255,255,255,.06) 50%,transparent 75%);
  background-size:200% 100%;animation:shimmer 1.4s ease infinite;opacity:0;pointer-events:none;
}
.flag-shimmer.loading{opacity:1}
@keyframes shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}

/* ── Reverse mode zone ── */
.reverse-question-card{
  background:var(--bg-card2);border:1px solid var(--border);
  border-radius:var(--r-md);padding:20px;text-align:center;
}
.reverse-label{font-size:.8rem;color:var(--muted);margin-bottom:6px;font-weight:500}
#reverse-country-name{font-size:1.4rem;font-weight:800;letter-spacing:-.02em}
.flag-choices-grid{
  display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px;
}
.flag-choice-btn{
  background:var(--bg-card2);border:2px solid var(--border);
  border-radius:var(--r-md);padding:8px;cursor:pointer;
  transition:all var(--t);overflow:hidden;
  display:flex;align-items:center;justify-content:center;
  aspect-ratio:3/2;
}
.flag-choice-btn img{width:100%;height:100%;object-fit:cover;border-radius:6px;display:block;transition:opacity .2s}
.flag-choice-btn:not(:disabled):hover{border-color:var(--accent);transform:scale(1.03)}
.flag-choice-btn.correct{border-color:var(--ok);box-shadow:0 0 0 3px rgba(34,197,94,.2)}
.flag-choice-btn.incorrect{border-color:var(--err);box-shadow:0 0 0 3px rgba(239,68,68,.15)}
.flag-choice-btn:disabled{cursor:not-allowed}

/* ── Hardcore zone ── */
.hardcore-hint{
  display:flex;align-items:center;justify-content:space-between;gap:8px;
  padding:0 2px;margin-bottom:4px;
}
.hc-label{font-size:.82rem;font-weight:600;color:var(--muted)}
.hc-tol{
  font-size:.72rem;font-weight:600;padding:3px 8px;border-radius:99px;
  background:rgba(245,158,11,.12);border:1px solid rgba(245,158,11,.25);color:var(--warn);
}
.hardcore-input-wrap{display:flex;gap:8px}
.hardcore-input{
  flex:1;padding:13px 14px;border-radius:var(--r-sm);
  border:1.5px solid var(--border);background:var(--bg-card2);
  color:var(--text);font-size:.95rem;font-family:inherit;
  outline:none;transition:border-color var(--t);
}
.hardcore-input:focus{border-color:var(--accent)}
.hardcore-input.ok{border-color:var(--ok)}
.hardcore-input.bad{border-color:var(--err)}
.btn-submit{
  padding:13px 18px;border-radius:var(--r-sm);border:none;
  background:var(--accent);color:#fff;font-weight:700;font-size:.9rem;
  cursor:pointer;transition:var(--t);white-space:nowrap;font-family:inherit;
}
.btn-submit:hover{filter:brightness(1.1)}
.btn-submit:disabled{opacity:.4;cursor:not-allowed}

/* ── Feedback banner ── */
.feedback-banner{
  display:flex;align-items:center;gap:10px;
  padding:11px 14px;border-radius:var(--r-sm);
  font-size:.88rem;font-weight:600;
  opacity:0;transform:scale(.96);pointer-events:none;min-height:44px;
  transition:all .22s cubic-bezier(.4,0,.2,1);
}
.feedback-banner.show{opacity:1;transform:scale(1);pointer-events:auto}
.feedback-banner.correct{background:var(--ok-bg);border:1px solid rgba(34,197,94,.25);color:var(--ok)}
.feedback-banner.incorrect{background:var(--err-bg);border:1px solid rgba(239,68,68,.25);color:var(--err)}
.feedback-banner.close-enough{background:rgba(245,158,11,.1);border:1px solid rgba(245,158,11,.25);color:var(--warn)}
#feedback-icon{font-size:1.05rem}

/* ── Answer buttons ── */
.answers-grid{display:grid;grid-template-columns:1fr 1fr;gap:9px}
.answer-btn{
  padding:13px 10px;border-radius:var(--r-sm);
  border:1.5px solid var(--border);background:var(--bg-card2);
  color:var(--text);font-family:inherit;font-size:.86rem;font-weight:500;
  cursor:pointer;transition:all var(--t);text-align:center;line-height:1.4;
}
.answer-btn:not(:disabled):hover{border-color:var(--accent);background:rgba(108,99,255,.08);transform:translateY(-1px)}
.answer-btn.correct{border-color:var(--ok);background:var(--ok-bg);color:var(--ok);font-weight:700;
  animation:popCorrect .28s ease}
.answer-btn.incorrect{border-color:var(--err);background:var(--err-bg);color:var(--err)}
.answer-btn:disabled{cursor:not-allowed}
@keyframes popCorrect{0%{transform:scale(1)}50%{transform:scale(1.04)}100%{transform:scale(1)}}

/* Bottom controls */
.bottom-controls{margin-top:2px;display:flex;flex-direction:column;gap:8px}
.btn-infini-home{margin-top:0}

/* Hidden helpers */
.hidden{display:none!important}

/* ======================================================
   RESULTS SCREEN
====================================================== */
.results-card{
  background:var(--bg-card);border:1px solid var(--border);
  border-radius:var(--r-lg);padding:36px 28px 32px;
  width:100%;text-align:center;box-shadow:var(--shadow);
  display:flex;flex-direction:column;align-items:center;gap:14px;
}
.results-emoji{font-size:3rem;filter:drop-shadow(0 4px 16px rgba(108,99,255,.4))}
h2{font-size:1.5rem;font-weight:800;letter-spacing:-.02em}

/* Ring */
.score-circle{position:relative;width:130px;height:130px;margin:4px 0}
.score-circle svg{width:100%;height:100%;transform:rotate(-90deg)}
.ring-bg{fill:none;stroke:var(--bg-card2);stroke-width:10}
.ring-fill{
  fill:none;stroke:var(--accent);stroke-width:10;stroke-linecap:round;
  stroke-dasharray:327;stroke-dashoffset:327;
  filter:drop-shadow(0 0 8px var(--accent));
  transition:stroke-dashoffset 1.1s cubic-bezier(.4,0,.2,1) .2s;
}
.score-inside{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center}
#final-score{font-size:2.4rem;font-weight:800;line-height:1}
.score-denom{font-size:.88rem;font-weight:600;color:var(--muted)}

/* Survival special */
.survival-result{display:none;flex-direction:column;align-items:center;gap:8px}
.survival-result.show{display:flex}
.streak-big{font-size:2.8rem;font-weight:800;line-height:1}
.streak-desc{font-size:.9rem;color:var(--muted)}
.record-row{display:flex;align-items:center;gap:8px;margin-top:4px}
.record-tag{
  font-size:.72rem;font-weight:700;padding:3px 10px;border-radius:99px;
  background:rgba(108,99,255,.15);border:1px solid rgba(108,99,255,.25);color:var(--accent);
}
#survival-record-display{font-size:1.1rem;font-weight:800;color:var(--text)}

/* Stats */
.results-stats{display:flex;gap:10px;width:100%}
.stat-item{
  flex:1;display:flex;align-items:center;gap:8px;
  padding:11px 14px;border-radius:var(--r-sm);font-size:.88rem;font-weight:600;
}
.stat-item.correct{background:var(--ok-bg);border:1px solid rgba(34,197,94,.18);color:var(--ok)}
.stat-item.incorrect{background:var(--err-bg);border:1px solid rgba(239,68,68,.18);color:var(--err)}
.stat-icon{font-size:1rem}

/* Chrono stats */
.chrono-result{display:none;flex-wrap:wrap;gap:10px;justify-content:center;width:100%}
.chrono-result.show{display:flex}
.chrono-stat{
  display:flex;align-items:center;gap:8px;
  background:var(--bg-card2);border:1px solid var(--border);
  border-radius:var(--r-sm);padding:10px 16px;font-size:.88rem;font-weight:600;
  flex:1;min-width:120px;
}
.chrono-stat-icon{font-size:1.1rem}

/* New record */
.new-record-badge{
  display:none;
  background:linear-gradient(135deg,rgba(108,99,255,.25),rgba(167,139,250,.2));
  border:1px solid rgba(108,99,255,.35);border-radius:99px;
  padding:8px 20px;font-size:.88rem;font-weight:700;color:var(--accent);
}
.new-record-badge.show{display:block}

/* Results buttons */
.results-buttons{display:flex;flex-direction:column;gap:8px;width:100%}

/* ======================================================
   RESPONSIVE
====================================================== */
@media(max-width:400px){
  body{padding:8px}
  .welcome-card,.selection-wrapper,.game-wrapper,.results-card{padding:20px 14px}
  h1{font-size:1.55rem}
  .continent-grid{grid-template-columns:1fr 1fr;gap:8px}
  .answers-grid{gap:7px}
  .answer-btn{font-size:.8rem;padding:11px 8px}
  #flag-img{max-width:220px}
  .flag-choices-grid{gap:8px}
}
@media(max-width:340px){
  .continent-grid{grid-template-columns:1fr}
}
